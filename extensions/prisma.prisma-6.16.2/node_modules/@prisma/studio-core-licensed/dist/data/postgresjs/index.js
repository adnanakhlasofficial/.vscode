import * as ___react___ from 'react';
import * as ___react_dom___ from 'react-dom'; 

function require(mod) {
  if (mod === 'react') return ___react___;
  if (mod === 'react-dom') return ___react_dom___;
  throw new Error(`Unknown module ${mod}`);
}
import{b as a}from"../../chunk-HJIBV67J.js";import{j as y,l as m,m as P}from"../../chunk-DHZCM7MU.js";import"../../chunk-AQXRIQHE.js";import{e as g}from"../../chunk-GDQBQ7MK.js";g();function q(r,t){let{logging:e=!1}=t??{};return{execute:async(o,S)=>{let{abortSignal:n}=S||{},u,i;try{let s=typeof e=="function"?e(o):e,l;if(s&&console.log("PostgresJSExecutor: Executing query:",l=JSON.stringify(o,null,2)),n?.aborted)return a();let x=Date.now(),d,v=new Promise(c=>d=c);if(n){if(i=await r.reserve(),n.aborted)return a();let c=await E(i);if(n.aborted)return a();c!=null&&n.addEventListener("abort",u=()=>d(c))}let f=await Promise.race([(i||r).unsafe(o.sql,o.parameters),v]),p=Date.now()-x;return typeof f!="object"?(b(r,f),s&&console.log("PostgresJSExecutor: Query cancelled after",p,"ms:",l),a()):(s&&console.log("PostgresJSExecutor: Query executed in",p,"ms:",l),[null,f])}catch(s){return[s]}finally{u&&n?.removeEventListener("abort",u),i?.release()}}}}function O(r,t){return y({executor:q(r,t)})}async function b(r,t){let e=P(t);try{await r.unsafe(e.sql,e.parameters)}catch(o){console.error("Failed to cancel query:",o)}}async function E(r){let t=m();try{let[e]=await r.unsafe(t.sql,t.parameters);return e?.pid}catch(e){console.error("Failed to get connection PID:",e);return}}export{O as createPostgresJSAdapter,q as createPostgresJSExecutor};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vLi4vZGF0YS9wb3N0Z3Jlc2pzL2luZGV4LnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgdHlwZSB7IFJlc2VydmVkU3FsLCBTcWwgfSBmcm9tIFwicG9zdGdyZXNcIjtcblxuaW1wb3J0IHR5cGUgeyBBZGFwdGVyIH0gZnJvbSBcIi4uL2FkYXB0ZXJcIjtcbmltcG9ydCB7IHR5cGUgRXhlY3V0b3IsIGdldEFib3J0UmVzdWx0IH0gZnJvbSBcIi4uL2V4ZWN1dG9yXCI7XG5pbXBvcnQgeyBjcmVhdGVQb3N0Z3Jlc0FkYXB0ZXIgfSBmcm9tIFwiLi4vcG9zdGdyZXMtY29yZVwiO1xuaW1wb3J0IHsgZ2V0Q2FuY2VsUXVlcnksIGdldFBJRFF1ZXJ5IH0gZnJvbSBcIi4uL3Bvc3RncmVzLWNvcmUvdXRpbGl0eVwiO1xuaW1wb3J0IHR5cGUgeyBRdWVyeSwgUXVlcnlSZXN1bHQgfSBmcm9tIFwiLi4vcXVlcnlcIjtcblxuZXhwb3J0IGludGVyZmFjZSBQb3N0Z3Jlc0pTRXhlY3V0b3JPcHRpb25zIHtcbiAgLyoqXG4gICAqIFdoZXRoZXIgdG8gbG9nIHRoZSBxdWVyeSBhbmQgaXRzIHBhcmFtZXRlcnMuXG4gICAqXG4gICAqIERlZmF1bHRzIHRvIGBmYWxzZWAuXG4gICAqL1xuICBsb2dnaW5nPzogYm9vbGVhbiB8ICgocXVlcnk6IFF1ZXJ5KSA9PiBib29sZWFuKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVBvc3RncmVzSlNFeGVjdXRvcihwb3N0Z3Jlc2pzOiBTcWwsIG9wdGlvbnM/OiBQb3N0Z3Jlc0pTRXhlY3V0b3JPcHRpb25zKTogRXhlY3V0b3Ige1xuICBjb25zdCB7IGxvZ2dpbmcgPSBmYWxzZSB9ID0gb3B0aW9ucyA/PyB7fTtcblxuICByZXR1cm4ge1xuICAgIGV4ZWN1dGU6IGFzeW5jIChxdWVyeSwgb3B0aW9ucykgPT4ge1xuICAgICAgY29uc3QgeyBhYm9ydFNpZ25hbCB9ID0gb3B0aW9ucyB8fCB7fTtcblxuICAgICAgbGV0IGFib3J0TGlzdGVuZXI6ICgoKSA9PiB2b2lkKSB8IHVuZGVmaW5lZDtcbiAgICAgIGxldCBjb25uZWN0aW9uOiBSZXNlcnZlZFNxbCB8IHVuZGVmaW5lZDtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3Qgc2hvdWxkTG9nID0gdHlwZW9mIGxvZ2dpbmcgPT09IFwiZnVuY3Rpb25cIiA/IGxvZ2dpbmcocXVlcnkpIDogbG9nZ2luZztcblxuICAgICAgICBsZXQgbG9nZ2FibGVRdWVyeTogc3RyaW5nO1xuICAgICAgICBpZiAoc2hvdWxkTG9nKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coXCJQb3N0Z3Jlc0pTRXhlY3V0b3I6IEV4ZWN1dGluZyBxdWVyeTpcIiwgKGxvZ2dhYmxlUXVlcnkgPSBKU09OLnN0cmluZ2lmeShxdWVyeSwgbnVsbCwgMikpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChhYm9ydFNpZ25hbD8uYWJvcnRlZCkge1xuICAgICAgICAgIHJldHVybiBnZXRBYm9ydFJlc3VsdCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcblxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWVtcHR5LW9iamVjdC10eXBlXG4gICAgICAgIGxldCB0cmlnZ2VyOiAocGlkOiB7fSkgPT4gdm9pZDtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1lbXB0eS1vYmplY3QtdHlwZVxuICAgICAgICBjb25zdCBhYm9ydGlvblByb21pc2UgPSBuZXcgUHJvbWlzZTx7fT4oKHJlc29sdmUpID0+ICh0cmlnZ2VyID0gcmVzb2x2ZSkpO1xuXG4gICAgICAgIGlmIChhYm9ydFNpZ25hbCkge1xuICAgICAgICAgIGNvbm5lY3Rpb24gPSBhd2FpdCBwb3N0Z3Jlc2pzLnJlc2VydmUoKTtcblxuICAgICAgICAgIGlmIChhYm9ydFNpZ25hbC5hYm9ydGVkKSB7XG4gICAgICAgICAgICByZXR1cm4gZ2V0QWJvcnRSZXN1bHQoKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb25zdCBwaWQgPSBhd2FpdCBnZXRDb25uZWN0aW9uUElEKGNvbm5lY3Rpb24pO1xuXG4gICAgICAgICAgaWYgKGFib3J0U2lnbmFsLmFib3J0ZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBnZXRBYm9ydFJlc3VsdCgpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChwaWQgIT0gbnVsbCkge1xuICAgICAgICAgICAgYWJvcnRTaWduYWwuYWRkRXZlbnRMaXN0ZW5lcihcImFib3J0XCIsIChhYm9ydExpc3RlbmVyID0gKCkgPT4gdHJpZ2dlcihwaWQpKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgUHJvbWlzZS5yYWNlKFtcbiAgICAgICAgICAoY29ubmVjdGlvbiB8fCBwb3N0Z3Jlc2pzKS51bnNhZmUocXVlcnkuc3FsLCBxdWVyeS5wYXJhbWV0ZXJzIGFzIG5ldmVyKSxcbiAgICAgICAgICBhYm9ydGlvblByb21pc2UsXG4gICAgICAgIF0pO1xuXG4gICAgICAgIGNvbnN0IGR1cmF0aW9uID0gRGF0ZS5ub3coKSAtIG5vdztcblxuICAgICAgICBpZiAodHlwZW9mIHJlc3VsdCAhPT0gXCJvYmplY3RcIikge1xuICAgICAgICAgIC8vIG5vdCBpbXBvcnRhbnQgZW5vdWdoIHRvIGF3YWl0LlxuICAgICAgICAgIHZvaWQgY2FuY2VsUXVlcnkocG9zdGdyZXNqcywgcmVzdWx0KTtcblxuICAgICAgICAgIGlmIChzaG91bGRMb2cpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUG9zdGdyZXNKU0V4ZWN1dG9yOiBRdWVyeSBjYW5jZWxsZWQgYWZ0ZXJcIiwgZHVyYXRpb24sIFwibXM6XCIsIGxvZ2dhYmxlUXVlcnkhKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4gZ2V0QWJvcnRSZXN1bHQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChzaG91bGRMb2cpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhcIlBvc3RncmVzSlNFeGVjdXRvcjogUXVlcnkgZXhlY3V0ZWQgaW5cIiwgZHVyYXRpb24sIFwibXM6XCIsIGxvZ2dhYmxlUXVlcnkhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBbbnVsbCwgcmVzdWx0IGFzIG5ldmVyXTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yOiB1bmtub3duKSB7XG4gICAgICAgIHJldHVybiBbZXJyb3IgYXMgRXJyb3JdO1xuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgaWYgKGFib3J0TGlzdGVuZXIpIHtcbiAgICAgICAgICBhYm9ydFNpZ25hbD8ucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImFib3J0XCIsIGFib3J0TGlzdGVuZXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29ubmVjdGlvbj8ucmVsZWFzZSgpO1xuICAgICAgfVxuICAgIH0sXG4gIH07XG59XG5cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZW1wdHktb2JqZWN0LXR5cGVcbmV4cG9ydCBpbnRlcmZhY2UgUG9zdGdyZXNKU0FkYXB0ZXJPcHRpb25zIGV4dGVuZHMgUG9zdGdyZXNKU0V4ZWN1dG9yT3B0aW9ucyB7fVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlUG9zdGdyZXNKU0FkYXB0ZXIocG9zdGdyZXNqczogU3FsLCBvcHRpb25zPzogUG9zdGdyZXNKU0FkYXB0ZXJPcHRpb25zKTogQWRhcHRlciB7XG4gIHJldHVybiBjcmVhdGVQb3N0Z3Jlc0FkYXB0ZXIoe1xuICAgIGV4ZWN1dG9yOiBjcmVhdGVQb3N0Z3Jlc0pTRXhlY3V0b3IocG9zdGdyZXNqcywgb3B0aW9ucyksXG4gIH0pO1xufVxuXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWVtcHR5LW9iamVjdC10eXBlXG5hc3luYyBmdW5jdGlvbiBjYW5jZWxRdWVyeShwb3N0Z3Jlc2pzOiBTcWwsIHBpZDoge30pOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgcXVlcnkgPSBnZXRDYW5jZWxRdWVyeShwaWQpO1xuXG4gIHRyeSB7XG4gICAgYXdhaXQgcG9zdGdyZXNqcy51bnNhZmUocXVlcnkuc3FsLCBxdWVyeS5wYXJhbWV0ZXJzIGFzIG5ldmVyKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGNhbmNlbCBxdWVyeTpcIiwgZXJyb3IpO1xuICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGdldENvbm5lY3Rpb25QSUQoY29ubmVjdGlvbjogUmVzZXJ2ZWRTcWwpOiBQcm9taXNlPHVua25vd24+IHtcbiAgY29uc3QgcXVlcnkgPSBnZXRQSURRdWVyeSgpO1xuXG4gIHRyeSB7XG4gICAgY29uc3QgW3Jlc3VsdF0gPSBhd2FpdCBjb25uZWN0aW9uLnVuc2FmZTxRdWVyeVJlc3VsdDx0eXBlb2YgcXVlcnk+PihxdWVyeS5zcWwsIHF1ZXJ5LnBhcmFtZXRlcnMgYXMgbmV2ZXIpO1xuXG4gICAgcmV0dXJuIHJlc3VsdD8ucGlkO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gZ2V0IGNvbm5lY3Rpb24gUElEOlwiLCBlcnJvcik7XG5cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG59XG4iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7OztrTEFBQUEsSUFpQk8sU0FBU0MsRUFBeUJDLEVBQWlCQyxFQUErQyxDQUN2RyxHQUFNLENBQUUsUUFBQUMsRUFBVSxFQUFNLEVBQUlELEdBQVcsQ0FBQyxFQUV4QyxNQUFPLENBQ0wsUUFBUyxNQUFPRSxFQUFPRixJQUFZLENBQ2pDLEdBQU0sQ0FBRSxZQUFBRyxDQUFZLEVBQUlILEdBQVcsQ0FBQyxFQUVoQ0ksRUFDQUMsRUFFSixHQUFJLENBQ0YsSUFBTUMsRUFBWSxPQUFPTCxHQUFZLFdBQWFBLEVBQVFDLENBQUssRUFBSUQsRUFFL0RNLEVBS0osR0FKSUQsR0FDRixRQUFRLElBQUksdUNBQXlDQyxFQUFnQixLQUFLLFVBQVVMLEVBQU8sS0FBTSxDQUFDLENBQUUsRUFHbEdDLEdBQWEsUUFDZixPQUFPSyxFQUFlLEVBR3hCLElBQU1DLEVBQU0sS0FBSyxJQUFJLEVBR2pCQyxFQUVFQyxFQUFrQixJQUFJLFFBQWFDLEdBQWFGLEVBQVVFLENBQVEsRUFFeEUsR0FBSVQsRUFBYSxDQUdmLEdBRkFFLEVBQWEsTUFBTU4sRUFBVyxRQUFRLEVBRWxDSSxFQUFZLFFBQ2QsT0FBT0ssRUFBZSxFQUd4QixJQUFNSyxFQUFNLE1BQU1DLEVBQWlCVCxDQUFVLEVBRTdDLEdBQUlGLEVBQVksUUFDZCxPQUFPSyxFQUFlLEVBR3BCSyxHQUFPLE1BQ1RWLEVBQVksaUJBQWlCLFFBQVVDLEVBQWdCLElBQU1NLEVBQVFHLENBQUcsQ0FBRSxDQUU5RSxDQUVBLElBQU1FLEVBQVMsTUFBTSxRQUFRLEtBQUssRUFDL0JWLEdBQWNOLEdBQVksT0FBT0csRUFBTSxJQUFLQSxFQUFNLFVBQW1CLEVBQ3RFUyxDQUNGLENBQUMsRUFFS0ssRUFBVyxLQUFLLElBQUksRUFBSVAsRUFFOUIsT0FBSSxPQUFPTSxHQUFXLFVBRWZFLEVBQVlsQixFQUFZZ0IsQ0FBTSxFQUUvQlQsR0FDRixRQUFRLElBQUksNENBQTZDVSxFQUFVLE1BQU9ULENBQWMsRUFHbkZDLEVBQWUsSUFHcEJGLEdBQ0YsUUFBUSxJQUFJLHdDQUF5Q1UsRUFBVSxNQUFPVCxDQUFjLEVBRy9FLENBQUMsS0FBTVEsQ0FBZSxFQUMvQixPQUFTRyxFQUFnQixDQUN2QixNQUFPLENBQUNBLENBQWMsQ0FDeEIsUUFBRSxDQUNJZCxHQUNGRCxHQUFhLG9CQUFvQixRQUFTQyxDQUFhLEVBR3pEQyxHQUFZLFFBQVEsQ0FDdEIsQ0FDRixDQUNGLENBQ0YsQ0FLTyxTQUFTYyxFQUF3QnBCLEVBQWlCQyxFQUE2QyxDQUNwRyxPQUFPb0IsRUFBc0IsQ0FDM0IsU0FBVXRCLEVBQXlCQyxFQUFZQyxDQUFPLENBQ3hELENBQUMsQ0FDSCxDQUdBLGVBQWVpQixFQUFZbEIsRUFBaUJjLEVBQXdCLENBQ2xFLElBQU1YLEVBQVFtQixFQUFlUixDQUFHLEVBRWhDLEdBQUksQ0FDRixNQUFNZCxFQUFXLE9BQU9HLEVBQU0sSUFBS0EsRUFBTSxVQUFtQixDQUM5RCxPQUFTZ0IsRUFBTyxDQUNkLFFBQVEsTUFBTSwwQkFBMkJBLENBQUssQ0FDaEQsQ0FDRixDQUVBLGVBQWVKLEVBQWlCVCxFQUEyQyxDQUN6RSxJQUFNSCxFQUFRb0IsRUFBWSxFQUUxQixHQUFJLENBQ0YsR0FBTSxDQUFDUCxDQUFNLEVBQUksTUFBTVYsRUFBVyxPQUFrQ0gsRUFBTSxJQUFLQSxFQUFNLFVBQW1CLEVBRXhHLE9BQU9hLEdBQVEsR0FDakIsT0FBU0csRUFBTyxDQUNkLFFBQVEsTUFBTSxnQ0FBaUNBLENBQUssRUFFcEQsTUFDRixDQUNGIiwKICAibmFtZXMiOiBbImluaXRfZGVmaW5lX0FDQ0VMRVJBVEVfU0NIRU1BX0JZX1BST1ZJREVSIiwgImNyZWF0ZVBvc3RncmVzSlNFeGVjdXRvciIsICJwb3N0Z3Jlc2pzIiwgIm9wdGlvbnMiLCAibG9nZ2luZyIsICJxdWVyeSIsICJhYm9ydFNpZ25hbCIsICJhYm9ydExpc3RlbmVyIiwgImNvbm5lY3Rpb24iLCAic2hvdWxkTG9nIiwgImxvZ2dhYmxlUXVlcnkiLCAiZ2V0QWJvcnRSZXN1bHQiLCAibm93IiwgInRyaWdnZXIiLCAiYWJvcnRpb25Qcm9taXNlIiwgInJlc29sdmUiLCAicGlkIiwgImdldENvbm5lY3Rpb25QSUQiLCAicmVzdWx0IiwgImR1cmF0aW9uIiwgImNhbmNlbFF1ZXJ5IiwgImVycm9yIiwgImNyZWF0ZVBvc3RncmVzSlNBZGFwdGVyIiwgImNyZWF0ZVBvc3RncmVzQWRhcHRlciIsICJnZXRDYW5jZWxRdWVyeSIsICJnZXRQSURRdWVyeSJdCn0K